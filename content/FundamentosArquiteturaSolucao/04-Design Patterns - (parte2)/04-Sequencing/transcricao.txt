Agora, meu caro amigo, minha cara amiga, nós vamos falar sobre Sequencing. O que é isso? Pode parecer a coisa mais louca do mundo, seguinte: quando você está em um ecossistema extremamente grande, você começa a ter alguns problemas que parecem ser muito bobos, mas eles não são. E, um desses problemas é a geração de IDs. Como assim? Olha só que coisa louca. Eu vou dar um exemplo baseado na galera do Mercado Livre. Os caras tem 26.000 microsserviços, pelo menos até o momento que eu estou gravando. Esses microsserviços ficam gerando IDs o tempo todo, vocês concordam comigo? Gerei uma transação, gerou com um ID, gerou outra transação, gerou com mais uma ID. Existem transações que conseguem acontecer praticamente no exato segundo e isso pode gerar um problema muito grave, concorda comigo? Imagina você ter um ID repetido? Isso aí é muito bizarro acontecer. E, existem muitas empresas que lá no início já trabalhavam com IDs sequenciais. Hoje a gente tem muito essa parada de UUID, mesmo assim, com UUID, matematicamente existe a chance de sair um UUID repetido. Mas, o que acontece? Existem muitas empresas que vieram do momento que o ID era sequencial, e o que acontece? Para evitar IDs que sejam colididos, você tem um serviço de Sequencing. Ao invés de você gerar o ID na sua máquina, no seu microsserviço, você vai acessar um serviço que vai gerar para você o ID. Então, o microsserviço 1 chamou o serviço de Sequencing e o serviço de Sequencing gerou o ID 1. Aqui gerou o ID 2, aqui gerou o ID 3 e assim a coisa vai acontecendo.

 

Quando você bate nesse serviço de Sequencing, o que acontece? Esse serviço tem o seu banco de dados, ele consegue trabalhar de forma atômica, ele evita qualquer tipo de concorrência que vai gerar IDs repetidos e ele tem que ser extremamente performático, porque todo mundo vai estar batendo nele. Ele vai guardar essas informações e ele vai guardar, por exemplo, qual o microsserviço que acessou e pediu aquela Sequencing e qual foi o momento que isso aconteceu. E, obviamente, ele é um serviço feito especificamente para aguentar esse tipo de concorrência, porque ele não pode também gerar IDs repetidos, entende? Então, o que acontece toda hora que você vai precisar gerar um novo produto? O que você faz? Bate no Sequencing, ele vai gerar um ID e você usa esse ID no seu produto. Ele é extremamente simples, a ideia. Mas, ele resolve um problema muito complexo que pode dar uma super bucha, realmente, quando você está em um mundo muito distribuído, com muitos serviços e que tem muitas transações por segundo acontecendo ali. Então, para evitar qualquer tipo de problema, você consegue ter esse serviço que vai gerar simplesmente IDs. Loucura, né? Pode parecer um exagero, mas acredite, não é. Esta é uma ideia básica de como é que funciona o Sequencing. Beleza? Um grande abraço e até mais!